{% extends "navbar.html" %}

{% block navbar_head %}
<meta name="google-signin-client_id" content="151432626794-3svgnd49h2fjmngk1cuatmrmna5n05jl.apps.googleusercontent.com">
{% endblock %}

{% block navbar_body %}

<script>
  function signOut() {
    var auth2 = gapi.auth2.getAuthInstance();
    auth2.signOut().then(function () {
      document.location = {{ url_for('index') }};
    });
  }
  function onLoad() {
    gapi.load('auth2', function() {
      gapi.auth2.init();
    });
  }
</script>

<div class="container">

  <div class="jumbotron">
    <h2>Hello, <strong>{{ current_user.name|e }}</strong>, welcome to your profile!</h2>
  </div>

  <a href={{ url_for('submit') }} class="btn btn-success">Submit Request</a>

  <div class="page-header">
    <h3>Your Active Requests</h3>
  </div>

  <div>
    {% if requests.count() > 0 %}
    <table class="table table-hover table-bordered">
      <thead>
        <tr>
          <th>Title</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        {% for request in requests %}
        <tr>
          <td class="col-md-4">{{ request.title|e }}</td>
          <td class="col-md-7">{{ request.description|e }}</td>
          <td class="col-md-1">
            <a class="btn btn-default" href={{ url_for('del_request', request_id=request.id) }} role="button">
              <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
              <span class="sr-only">Delete this post</span>
            </a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <p>No requests yet! Click the "Submit Request" button to submit your first request.</p>
    {% endif %}
  </div>

  <div class="page-header">
    <h3>Options</h3>
  </div>

  <div>
    <ul>
      <li><a href="javascript:void(0)" onclick="signOut();">Sign out</a></li>
      <li><p>Delete account</p></li>
    </ul>
  </div>

</div>

<script src="https://apis.google.com/js/platform.js?onload=onLoad" async defer></script>
{% endblock %}
